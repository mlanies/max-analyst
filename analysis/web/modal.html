<!-- Модальное окно для мониторинга безопасности MAX Messenger -->
<div id="http-requests-modal" class="modal">
    <div class="modal-content modal-large">
        <div class="modal-header">
            <h2>MAX Messenger Security Monitor</h2>
            <span class="close" onclick="closeHttpModal()">&times;</span>
        </div>
        
        <div class="modal-body">
            <!-- Информация о приложении -->
            <div class="app-info-section">
                <h3>Application Security Status</h3>
                <div class="security-grid">
                    <div class="security-item">
                        <label>Package:</label>
                        <span id="app-package">ru.oneme.app</span>
                    </div>
                    <div class="security-item">
                        <label>Status:</label>
                        <span id="app-status" class="status-safe">Safe</span>
                    </div>
                    <div class="security-item">
                        <label>Root Access:</label>
                        <span id="root-status" class="status-safe">No Root</span>
                    </div>
                    <div class="security-item">
                        <label>Permissions:</label>
                        <span id="permissions-count">0</span>
                    </div>
                </div>
                <div class="info-note">
                    <p><strong>Важно:</strong> Данные показывают активность только приложения MAX Messenger. Системные процессы и другие приложения не учитываются.</p>
                </div>
            </div>

            <!-- Мониторинг подозрительной активности -->
            <div class="monitoring-section">
                <h3>Suspicious Activity Monitor</h3>
                <div class="monitoring-grid">
                    <div class="monitor-item">
                        <div class="monitor-header">
                            <span class="monitor-title">Network Spying</span>
                            <span class="monitor-status status-safe" id="network-spying-status">No Activity</span>
                        </div>
                        <div class="monitor-details" id="network-spying-details">No suspicious network connections detected</div>
                    </div>
                    
                    <div class="monitor-item">
                        <div class="monitor-header">
                            <span class="monitor-title">Permission Abuse</span>
                            <span class="monitor-status status-safe" id="permission-status">No Activity</span>
                        </div>
                        <div class="monitor-details" id="permission-details">No dangerous permissions detected</div>
                    </div>
                    
                    <div class="monitor-item">
                        <div class="monitor-header">
                            <span class="monitor-title">Camera Access</span>
                            <span class="monitor-status status-safe" id="camera-status">No Activity</span>
                        </div>
                        <div class="monitor-details" id="camera-details">No unauthorized camera access detected</div>
                    </div>
                    
                    <div class="monitor-item">
                        <div class="monitor-header">
                            <span class="monitor-title">File Access</span>
                            <span class="monitor-status status-safe" id="file-status">No Activity</span>
                        </div>
                        <div class="monitor-details" id="file-details">No unauthorized file access detected</div>
                    </div>
                    
                    <div class="monitor-item">
                        <div class="monitor-header">
                            <span class="monitor-title">Location Tracking</span>
                            <span class="monitor-status status-safe" id="location-status">No Activity</span>
                        </div>
                        <div class="monitor-details" id="location-details">No location tracking detected</div>
                    </div>
                    
                    <div class="monitor-item">
                        <div class="monitor-header">
                            <span class="monitor-title">System Monitoring</span>
                            <span class="monitor-status status-safe" id="system-status">Active</span>
                        </div>
                        <div class="monitor-details" id="system-details">Security monitoring is active</div>
                    </div>
                </div>
            </div>

            <!-- Анализ аномалий -->
            <div class="anomaly-section">
                <h3>Anomaly Analysis</h3>
                <div class="anomaly-summary">
                    <div class="anomaly-card high-risk" id="high-risk-card">
                        <div class="anomaly-header">
                            <span class="anomaly-title">High Risk</span>
                            <span class="anomaly-count" id="high-risk-count">0</span>
                        </div>
                        <div class="anomaly-description">Critical security threats detected</div>
                    </div>
                    
                    <div class="anomaly-card medium-risk" id="medium-risk-card">
                        <div class="anomaly-header">
                            <span class="anomaly-title">Medium Risk</span>
                            <span class="anomaly-count" id="medium-risk-count">0</span>
                        </div>
                        <div class="anomaly-description">Potential security concerns</div>
                    </div>
                    
                    <div class="anomaly-card low-risk" id="low-risk-card">
                        <div class="anomaly-header">
                            <span class="anomaly-title">Low Risk</span>
                            <span class="anomaly-count" id="low-risk-count">0</span>
                        </div>
                        <div class="anomaly-description">Minor security events</div>
                    </div>
                </div>
                
                <div class="anomaly-details" id="anomaly-details">
                    <!-- Детали аномалий будут добавлены динамически -->
                </div>
            </div>

            <!-- Фильтры для сетевой активности -->
                            <div class="filters">
                    <div class="filter-group">
                        <label>Activity Type:</label>
                        <select id="activity-filter" onchange="filterRequests()">
                            <option value="">All Activities</option>
                            <option value="api">API Calls</option>
                            <option value="media">Media Upload</option>
                            <option value="google">Google Services</option>
                            <option value="social">Social Media</option>
                            <option value="suspicious">Suspicious</option>
                            <option value="file">File Access</option>
                            <option value="camera">Camera Access</option>
                            <option value="audio">Audio Recording</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>Status:</label>
                        <select id="status-filter" onchange="filterRequests()">
                            <option value="">All Status</option>
                            <option value="normal">Normal</option>
                            <option value="suspicious">Suspicious</option>
                            <option value="warning">Warning</option>
                        </select>
                    </div>
                
                <div class="filter-group">
                    <label>Domain:</label>
                    <input type="text" id="domain-filter" placeholder="Filter by domain..." onkeyup="filterRequests()">
                </div>
                
                <div class="filter-group">
                    <label>Time Range:</label>
                    <select id="time-filter" onchange="filterRequests()">
                        <option value="all">All Time</option>
                        <option value="1h">Last Hour</option>
                        <option value="24h">Last 24 Hours</option>
                        <option value="7d">Last 7 Days</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <button class="btn btn-secondary" onclick="clearFilters()">Clear Filters</button>
                    <button class="btn btn-primary" onclick="refreshRequests()">Refresh</button>
                </div>
            </div>
            
            <!-- Статистика безопасности -->
            <div class="stats-bar">
                <div class="stat-item">
                    <span class="stat-label">Total Requests:</span>
                    <span class="stat-value" id="total-requests">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">API Calls:</span>
                    <span class="stat-value" id="legitimate-api">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Google Services:</span>
                    <span class="stat-value" id="google-services">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Suspicious:</span>
                    <span class="stat-value" id="suspicious-activity">0</span>
                </div>
            </div>
            
            <!-- Таблица активности -->
            <div class="table-container">
                <table id="requests-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Type</th>
                            <th>URL/Domain</th>
                            <th>Purpose</th>
                            <th>Data Size</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="requests-tbody">
                        <!-- Данные будут добавлены динамически -->
                    </tbody>
                </table>
            </div>
            
            <!-- Пагинация -->
            <div class="pagination">
                <button class="btn btn-secondary" onclick="previousPage()" id="prev-btn">Previous</button>
                <span id="page-info">Page 1 of 1</span>
                <button class="btn btn-secondary" onclick="nextPage()" id="next-btn">Next</button>
            </div>
        </div>
        
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="exportSecurityReport()">Export Security Report</button>
            <button class="btn btn-secondary" onclick="exportRequests()">Export CSV</button>
            <button class="btn btn-primary" onclick="closeHttpModal()">Close</button>
        </div>
    </div>
</div>

<!-- Модальное окно для деталей запроса -->
<div id="request-details-modal" class="modal">
    <div class="modal-content modal-large">
        <div class="modal-header">
            <h2>Activity Details</h2>
            <span class="close" onclick="closeDetailsModal()">&times;</span>
        </div>
        
        <div class="modal-body">
            <div class="request-details">
                <div class="detail-section">
                    <h3>Activity Information</h3>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <label>Method:</label>
                            <span id="detail-method">-</span>
                        </div>
                        <div class="detail-item">
                            <label>URL/Endpoint:</label>
                            <span id="detail-url">-</span>
                        </div>
                        <div class="detail-item">
                            <label>Status:</label>
                            <span id="detail-status">-</span>
                        </div>
                        <div class="detail-item">
                            <label>Time:</label>
                            <span id="detail-time">-</span>
                        </div>
                        <div class="detail-item">
                            <label>Data Size:</label>
                            <span id="detail-size">-</span>
                        </div>
                        <div class="detail-item">
                            <label>Duration:</label>
                            <span id="detail-duration">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3>Request Headers</h3>
                    <pre id="detail-request-headers" class="code-block">-</pre>
                </div>
                
                <div class="detail-section">
                    <h3>Response Headers</h3>
                    <pre id="detail-response-headers" class="code-block">-</pre>
                </div>
                
                <div class="detail-section">
                    <h3>Request Body</h3>
                    <pre id="detail-request-body" class="code-block">-</pre>
                </div>
                
                <div class="detail-section">
                    <h3>Response Body</h3>
                    <pre id="detail-response-body" class="code-block">-</pre>
                </div>
            </div>
        </div>
        
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeDetailsModal()">Close</button>
        </div>
    </div>
</div>


